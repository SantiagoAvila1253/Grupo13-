1. Objetivo general

El sistema gestiona el presentismo de los alumnos de una única comisión.
Las funciones principales del sistema son:
- Registrar la asistencia de cada alumno en cada clase.
- Calcular y persistir el porcentaje de asistencia de cada alumno.
- Aplicar la baja lógica si supera el 25 % de inasistencias injustificadas.
- Generar reportes (por clase, por alumno y globales).
- Controlar el acceso con docentes autenticados.

El sistema está implementado en Python con persistencia en archivos JSON y CSV.
Se prioriza modularidad, validaciones, manejo de excepciones y una UX clara por consola.


2. Modelo de datos

No se usa una base relacional ni variables globales como “fuente de verdad”.
Toda la información persistente vive en data/.

2.1 Archivos JSON

- data/alumnos.json: diccionario de diccionarios, indexado por legajo (string).
  Cada alumno incluye: legajo (int), apellido, nombre, dni, nacimiento, mail,
  "% asistencia" (float con 2 decimales) y "activo" (bool).
  Los legajos comienzan en 30000.

- data/clases.json: diccionario de diccionarios, indexado por id_clase (string).
  Cada clase incluye: id_clase (int), materia, fecha (YYYY-MM-DD), dia y horario.
  Los IDs de clase comienzan en 20000. Las clases están predefinidas.

- data/docentes.json: diccionario de diccionarios, indexado por id_docente (string).
  Cada registro contiene credenciales y estado (activo). IDs desde 10000.

Justificación:
- Cohesión por entidad, lectura selectiva, acceso O(1) por clave y menor acoplamiento.

2.2 Archivo CSV

- data/asistencia.csv: histórico transaccional (lista de filas).
  Cabecera fija: clase_id;legajo;apellido;nombre;estado
  estado ∈ {"P","AJ","AI",""} (vacío = sin marcar).

Reglas:
- Cada fila representa un alumno en una clase.
- Las filas se agregan y se sobrescriben por bloque de clase cuando corresponde.
- No se elimina histórico.
- Alumnos inactivos quedan en el CSV histórico, pero no aparecen en nuevas tomas.


3. Flujo de toma de asistencia

Paso 1. Selección de clase
- El docente elige id_clase.

Paso 2. Sincronización previa
- Se cargan JSON/CSV.
- Se arma en memoria el conjunto de filas de esa clase para todos los alumnos activos.
  Si falta una fila, se crea con estado="".
- La lista se ordena solo para visualización.

Paso 3. Registro
- Se pide P/AJ/AI (o Enter para dejar sin cambios) alumno por alumno.
- En modo “modificar desde legajo”, se comienza desde un legajo y se puede circular.

Paso 4. Guardado
- Se escribe el bloque de la clase en el CSV (sobrescritura controlada).
- Se recalculan porcentajes y se aplican bajas lógicas si corresponde.


4. Cálculo de asistencia y baja automática (25 %)

- total_clases = cantidad de claves en clases.json.
- presentes = conteo de filas CSV con estado == "P".
- "% asistencia" = (presentes/total_clases)*100 (dos decimales) en alumnos.json.
- inasistencias injustificadas = estado == "AI". Si (AI/total_clases)*100 > 25 → activo=false.


5. Módulos del sistema

5.1 core/
- es_json.py: lectura/escritura JSON; CRUD lógico; pausas y mensajes; respaldo JSON en error.
- es_csv.py: lectura con readline(); validación mínima de filas; escritura (append / sobrescribir)
  y respaldo CSV SOLO en errores de escritura; sin pausas en éxito.
- estadisticas.py: recálculo de "% asistencia" y aplicación de la regla del 25 %.
- validadores.py: DNI, mail, fecha, nombres, opciones de menú, estados de asistencia, etc.
- helpers.py: listados reutilizables (clases y alumnos) y formato unificado de nombres en MAYÚSCULAS.
  **Novedad**: listar_alumnos_resumen puede mostrar columna “Asist.” con el estado vigente para una clase dada.
- menus.py: UI por consola y navegación.
- datos.py: constantes (cabecera CSV, separadores, mapeos simbólicos).

5.2 funcionalidades/
- asistencia.py: sincronización, toma de asistencia (dos modos), modificación desde legajo,
  integración con helpers para mostrar listados previos con columna “Asist.”, guardado y recálculo.
- reportes.py: asistencia global, presentes por clase, porcentaje por alumno y top 5 inasistencias.
- alumnos.py: alta, baja lógica, reactivación y modificación.

5.3 login/
- autenticacion.py: validación de DNI/clave contra docentes.json (solo activos).

5.4 tests/
- tests/test_unitarios_docentes.py: estructura/valores de docentes + validaciones.
- tests/test_unitarios_asistencia.py: cabecera/filas del CSV y validaciones por fila.
- tests/test_unitarios_alumnos.py: forma JSON alumnos (diccionario de diccionarios) y campos clave.


6. Manejo de excepciones y UX por consola

- Lectura CSV: si archivo vacío o mal formado → se informa y se vuelve al menú (pausa). No hay respaldo.
- Escritura CSV/JSON: ante OSError se ofrece respaldo con marca temporal (carpeta data/respaldo/).
  Si el respaldo se guarda, se informa la ruta y se pausa; si falla, se informa y se pausa.
- Éxito: mensajes breves (p. ej. “La acción se realizó correctamente.”) sin pausas innecesarias.
- Se redujo “ruido” en consola y se mantuvieron prints informativos clave (leyendo, guardando, etc.).
- Colores/énfasis: opcional por terminal; el código deja el formato listo para incorporarlos.

7. Arquitectura y estructura del proyecto

GRUPO13/
├─ app_presentismo.py
├─ README.md
├─ MODELO_FUNCIONAL.txt
├─ .gitignore
│
├─ core/
│  ├─ datos.py
│  ├─ es_json.py
│  ├─ es_csv.py
│  ├─ estadisticas.py
│  ├─ helpers.py
│  ├─ menus.py
│  ├─ validadores.py
│  └─ __init__.py
│
├─ data/
│  ├─ alumnos.json
│  ├─ clases.json
│  ├─ docentes.json
│  ├─ asistencia.csv
│  ├─ respaldo/   (destino de backups con timestamp)
│  └─ __init__.py
│
├─ funcionalidades/
│  ├─ alumnos.py
│  ├─ asistencia.py
│  ├─ reportes.py
│  └─ __init__.py
│
├─ login/
│  ├─ autenticacion.py
│  └─ __init__.py
│
└─ tests/
   ├─ test_unitarios_docentes.py
   ├─ test_unitarios_asistencia.py
   ├─ test_unitarios_alumnos.py
   └─ __init__.py

Notas finales
- Se hizo hincapié en modularidad, helpers compartidos y mensajes claros.
- Se incorporó una política explícita de respaldo SOLO en errores de escritura.
- Los listados previos (clases/alumnos) mejoran la experiencia y evitan errores de selección.
